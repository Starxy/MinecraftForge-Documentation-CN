# 调试分析器

Minecraft 提供了一个可以查找耗时代码的调试分析器。关注 `TickEvents` 和 `TileEntities` 等内容，有利于 mod 开发者和服务器管理者对卡顿情况来源进行排查。

## 使用调试分析器

调试分析器使用的非常简单。只需要两个命令：`/debug start` 命令用来启动；`/debug stop` 用来停止。在调试程序运行时，调试程序会收集数据来进行分析。

显而易见的，你收集的数据越多，分析产生的结果越准确。我们建议进行调试分析要收集不少于一分钟的数据。

!!! note
  当然你只能对实际上游戏运行能访问到的代码进行分析。比如，如果你想对某些实体进行测试分析，该实体必须在世界中存在，这样的话调试分析器才能捕捉到该实体。

当你停止调试调试分析器时，分析器会在你的运行目录中生成一个名为 `debug` 的文件夹，同时在该文件夹中生成一个 `profile-results-yyyy-mm-dd_hh.mi.ss.txt` 命名格式的文件。该文件为本次分析的报告。

## 阅读调试分析报告

文件开头部分告诉了你本次调试分析总共花费了多少毫秒，并且在该时间内产生了多少个 tick。

紧跟着你可以找到类似于以下形式的文本。

```text
[00] levels - 96.70%/96.70%
[01] |   World Name - 99.76%/96.47%
[02] |   |   tick - 99.31%/95.81%
[03] |   |   |   entities - 47.72%/45.72%
[04] |   |   |   |   regular - 98.32%/44.95%
[04] |   |   |   |   blockEntities - 0.90%/0.41%
[05] |   |   |   |   |   unspecified - 64.26%/0.26%
[05] |   |   |   |   |   minecraft:furnace - 33.35%/0.14%
[05] |   |   |   |   |   minecraft:chest - 2.39%/0.01%
```

让我们以第三行为例来简单解释以下各个部分代表什么意思

| [02]                     | tick                  | 99.31%       | 95.81%       |
| :----------------------- | :---------------------- | :----------- | :----------- |
| 该部分的深度 | 该部分的名称 | 所用时间与父节点时间之比 | 所用时间与总调试分析器运行时间之比 |

## 对你的代码进行分析

默认得调试分析器仅对 `Entity` 和 `TileEntity` 提供了基本的支持。如果你想对其他的一些东西进行分析，你需要手动创建如下的部分。

```JAVA
  Profiler#startSection(yourSectionName : String);
  //你想分析的代码
  Profiler#endSection();
```

你可以从 `World`、`MinecraftServer` 或 `Minecraft` 实例处获取 `Profiler` 实例。

添加该部分代码后，你可以在分析报告中找到名为 section name 的部分，这部分就为你指定的代码产生的报告结果。
